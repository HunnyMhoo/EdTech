---
description: Defines API contract and interaction patterns between frontend and backend services for mission-based learning system
globs: backend/routes/*,frontend/src/features/*/api/*,frontend/src/services/*
alwaysApply: false
---


# api-integration

### Core API Endpoints

#### Mission Management Endpoints
- `GET /missions/daily/{user_id}`
  - Retrieves or generates daily mission for user
  - Returns 5 unique questions and current mission status
  - Handles timezone-specific (UTC+7) date logic
  - Importance: 95

- `PUT /missions/{mission_id}/progress` 
  - Updates mission progress including:
    - Current question index
    - User answers
    - Mission completion status
  - Automatically transitions states (not_started -> in_progress -> complete)
  - Importance: 90

#### Question Management Endpoints
- `GET /questions/{question_id}`
  - Retrieves question details including choices and feedback
  - Used for progressive question loading during mission
  - Importance: 85

### API Response Models

#### Mission Response Model
```typescript
interface Mission {
  id: string;
  userId: string;
  status: 'not_started' | 'in_progress' | 'complete' | 'archived';
  questions: Question[];
  currentQuestionIndex: number;
  answers: Answer[];
  date: string; // UTC+7 midnight timestamp
}
```
Importance: 90

#### Progress Update Model
```typescript
interface MissionProgress {
  currentQuestionIndex: number;
  answer: {
    questionId: string;
    selectedChoiceId: string;
  };
}
```
Importance: 85

### Integration Patterns

#### Mission State Management
- Frontend maintains mission state using `useMission` hook
- Syncs with backend on:
  - Initial load
  - Answer submission
  - Question navigation
  - Mission completion
- Importance: 85

#### Error Handling
- Standard error responses include:
  - 404: Mission/Question not found
  - 409: Duplicate mission creation
  - 422: Invalid mission progress update
- Frontend displays user-friendly error messages via notification service
- Importance: 75

#### Timezone Handling
- All API requests/responses use UTC+7 timezone
- Date synchronization ensures consistent mission generation
- Mission archival based on local timezone
- Importance: 80

$END$

 If you're using this file in context, clearly say in italics in one small line that "Context added by Giga api-integration".